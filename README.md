# Ohmjs Syntax Highlighting with CSS.highlights API

Prototype to have "web native" syntax highlights for [ohmjs](https://ohmjs.org/) grammars using the new (Baseline 2025) [CSS.highlights](https://developer.mozilla.org/en-US/docs/Web/API/CSS/highlights_static) browser feature.

See a demo here: https://marianoguerra-atik.github.io/ohm-highlight/

## What's in the repo

I took [the grammar of the wafer language](https://github.com/wasmgroundup/code/blob/d734998c65fa9483f855054bd03846f2bc26493f/chapter10/04-strings.js#L52) from the [WebAssembly from the Ground Up](https://wasmgroundup.com/) book and created a new semantic operation called `toHLInfo(ctx)` that [collects the ranges](https://github.com/marianoguerra-atik/ohm-highlight/blob/8743e989082b0c12a8f24a34d7ca3017742bf2f0/ohm-hl.js#L103) for different syntactic/semantic elements into a data structure called [HLInfo](https://github.com/marianoguerra-atik/ohm-highlight/blob/8743e989082b0c12a8f24a34d7ca3017742bf2f0/ohm-hl.js#L227).

Then I use that data structure to create the [Range](https://developer.mozilla.org/en-US/docs/Web/API/Range) values for each type [for a provided source code](https://github.com/marianoguerra-atik/ohm-highlight/blob/8743e989082b0c12a8f24a34d7ca3017742bf2f0/app.js#L31) and add it to `CSS.highlights`.

Finally I created a basic [highlight css file](https://github.com/marianoguerra-atik/ohm-highlight/blob/8743e989082b0c12a8f24a34d7ca3017742bf2f0/hl.css) to highlight the types of ranges generated by `toHLInfo(ctx)`.

## How you can use it

- take the `HLInfo` class
- take the `highlightCodeInNode` function
- create a `toHLInfo(ctx)` semantic operation for your grammar
- create a highlights css file for your types
- ???
- profit

## Notes

You don't need to ship ohm and the grammar to highlight if the programs are known ahead of time, just ship the `byType` data structure as JSON and call `highlightCodeInNodeFromData` instead of `getHighlightInfo(code)`.

## License

MIT
